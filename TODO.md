TODO: requireScopes.middleware.ts needed or not? decide
10-02-2026
TODO: replace email cookie with sessionId
TODO: verify OAuth state against session
TODO: refresh Gmail access token when expired
TODO: how to make sure upgrade is called only user already exists in DB
